---
# tasks file for linux_deploy_kontrast
# https://docs.ansible.com/ansible/latest/collections/ansible/builtin/apt_module.html
# https://apps.kde.org/fr/kontrast/
# https://ubuntuhandbook.org/index.php/2021/11/check-contrast-colors-ubuntu-kontrast/

  - name: update apt cache and install the latest kontrast package
    become: true
    apt: 
      name: kontrast 
      update_cache: yes
      state: latest

  - name: create an application symlink launcher on the desktop
    ansible.builtin.shell: |
      for user in /
        do
          symlink_path="/home/$user/Desktop/kontrast.desktop"
          target_path="/usr/share/applications/org.kde.kontrast.desktop"
          # Check if the symlink already exists
          if [ ! -e "$symlink_path" ]; then
            ln -s "$target_path" "$symlink_path"
            # Make the symlink executable 
            chmod +x "$symlink_path"
            # Create a desktop entry file
            # echo -e "[Desktop Entry]\nName=Kontrast\nExec=$target_path\nType=Application" > "$symlink_path"
            # chown "$user" "$symlink_path"
          else
            echo "symlink already exists for $user"
          fi
        done