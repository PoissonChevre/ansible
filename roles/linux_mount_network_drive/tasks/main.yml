---
# tasks file for linux_mount_network_drive
# tasks file for linux_copy_file
# https://docs.ansible.com/ansible/latest/collections/ansible/builtin/copy_module.html

- name: ensure required packages are installed
  apt: 
    name:
      - keyutils
      - cifs-utils
    state: present

- name: copy file with owner and permissions
  ansible.builtin.copy:
    src: /etc/ansible/roles/linux_mount_network_drive/file/mount_smb_share.sh
    dest: /home/
    owner: u.ansible
    group: gdl_barzini_authentificated_users
    mode: '0755'

- name: create common login script for all users
  template:
    src: /etc/ansible/roles/linux_mount_network_drive/file/logon_mnt_smb.sh.j2
    dest: /etc/profile.d/logon_mnt_smb.sh
    mode: '0755'
